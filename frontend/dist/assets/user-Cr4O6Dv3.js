import{B as n,m as s}from"./index-D_A4Kxuy.js";const i=n("user",{state:()=>({plans:[],checkins:[],todayCheckin:null,groups:{created:[],joined:[]},loading:!1,error:null}),actions:{async fetchPlans(){var e,t;this.loading=!0,this.error=null;try{const a=await s.plans.getPlans();return this.plans=a.data.data.items,a}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"获取计划失败",a}finally{this.loading=!1}},async createPlan(e){var t,a;this.loading=!0,this.error=null;try{const r=await s.plans.createPlan(e);return await this.fetchPlans(),r}catch(r){throw this.error=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"创建计划失败",r}finally{this.loading=!1}},async fetchTodayCheckin(){var e,t;this.loading=!0,this.error=null;try{const a=await s.checkins.getTodayCheckins();return this.todayCheckin=a.data.data&&a.data.data.total_hours>0?a.data.data:null,a}catch(a){throw this.todayCheckin=null,this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"获取今日打卡失败",a}finally{this.loading=!1}},async createCheckin(e){var t,a;this.loading=!0,this.error=null;try{const r=await s.checkins.createCheckin(e);return await this.fetchTodayCheckin(),r}catch(r){throw this.error=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"创建打卡失败",r}finally{this.loading=!1}},async fetchGroups(){var e,t;this.loading=!0,this.error=null;try{const a=await s.groups.getGroups();return this.groups=a.data.data,a}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"获取群组失败",a}finally{this.loading=!1}},async deletePlan(e){var t,a;this.loading=!0,this.error=null;try{const r=await s.plans.deletePlan(e);return await this.fetchPlans(),r}catch(r){throw this.error=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"删除计划失败",r}finally{this.loading=!1}}}});export{i as u};

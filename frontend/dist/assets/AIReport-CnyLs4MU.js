import{_ as T,u as $,j as H,o as n,c as i,a as s,b as l,w as a,m as L,r as _,f as m,h as S,t as v,F as B,n as D,d as W,e as N}from"./index-DnlmHtx4.js";const j={class:"ai-report-container"},z={class:"report-card"},G={key:0,class:"report-content"},J={class:"score-section"},K={class:"score-card"},O={class:"total-score"},P={class:"score-details"},Q={class:"score-item"},X={class:"score-item"},Y={class:"score-item"},Z={class:"summary-section"},ee={class:"summary-item"},se={class:"summary-value"},le={class:"summary-item"},te={class:"summary-value"},ae={class:"summary-item"},oe={class:"summary-value"},ne={class:"issues-suggestions"},re={class:"issues-section"},ie={key:0},de={key:1,class:"no-issues"},ue={class:"suggestions-section"},ce={key:0},_e={key:1,class:"no-suggestions"},pe={class:"recommended-section"},me={class:"recommended-hours"},ve={class:"hours-value"},ye={key:1,class:"loading-report"},ge={class:"ai-coach-card"},fe={class:"learning-data-form"},he={key:0,class:"coach-response"},ke=["innerHTML"],be={key:1,class:"loading-coach"},Ve={__name:"AIReport",setup(we){const b=$(),V=m(new Date),t=m(null),g=m(""),r=m({learning_goal:"考研数学",weekly_total_hours:12,average_daily_hours:1.7,target_daily_hours:3,consecutive_checkin_days:3,missed_checkin_days:2}),w=m(null),f=m(""),C=m(!1),x=async()=>{var d,e;try{g.value="";const c=await L.ai.getWeeklyReport({week_date:V.value});t.value=c.data.data}catch(c){g.value=((e=(d=c.response)==null?void 0:d.data)==null?void 0:e.message)||"生成报告失败，请稍后重试",console.error("生成报告失败:",c)}},q=async()=>{var d,e;try{C.value=!0,f.value="";let u=(await L.ai.getLearningCoach(r.value)).data.data.ai_response.replace(/\n/g,"<br>").replace(/- (.*?)<br>/g,"<li>$1</li>").replace(/(<li>.*?<\/li>)/gs,"<ul>$1</ul>");w.value=u}catch(c){f.value=((e=(d=c.response)==null?void 0:d.data)==null?void 0:e.message)||"获取学习指导失败，请稍后重试",console.error("获取学习指导失败:",c)}finally{C.value=!1}},h=d=>d>=80?"#67C23A":d>=60?"#E6A23C":"#F56C6C",E=d=>`${d}分`;return H(async()=>{b.isAuthenticated&&!b.user&&await b.fetchUserInfo(),x()}),(d,e)=>{const c=_("el-date-picker"),u=_("el-form-item"),U=_("el-button"),R=_("el-form"),k=_("el-progress"),p=_("el-card"),F=_("el-empty"),I=_("el-alert"),M=_("el-input"),y=_("el-input-number");return n(),i("div",j,[e[23]||(e[23]=s("h1",{class:"page-title"},"AI学习评估",-1)),s("div",z,[l(p,{"body-style":{padding:"30px"}},{default:a(()=>[e[20]||(e[20]=s("h2",{class:"card-title"},"本周学习报告",-1)),l(R,{inline:!0,class:"week-form"},{default:a(()=>[l(u,{label:"周开始日期"},{default:a(()=>[l(c,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=o=>V.value=o),type:"date",placeholder:"选择周开始日期",onChange:x},null,8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(U,{type:"primary",onClick:x},{default:a(()=>[...e[7]||(e[7]=[S(" 生成报告 ",-1)])]),_:1})]),_:1})]),_:1}),t.value?(n(),i("div",G,[s("div",J,[e[11]||(e[11]=s("h3",{class:"section-title"},"学习评分",-1)),s("div",K,[s("div",O,[l(k,{type:"dashboard",percentage:t.value.score.total,color:h(t.value.score.total),format:E,"stroke-width":15,width:150},null,8,["percentage","color"])]),s("div",P,[s("div",Q,[e[8]||(e[8]=s("span",{class:"score-label"},"打卡频率",-1)),l(k,{percentage:t.value.score.frequency,color:h(t.value.score.frequency)},null,8,["percentage","color"])]),s("div",X,[e[9]||(e[9]=s("span",{class:"score-label"},"学习时长",-1)),l(k,{percentage:t.value.score.duration,color:h(t.value.score.duration)},null,8,["percentage","color"])]),s("div",Y,[e[10]||(e[10]=s("span",{class:"score-label"},"学习稳定性",-1)),l(k,{percentage:t.value.score.stability,color:h(t.value.score.stability)},null,8,["percentage","color"])])])])]),s("div",Z,[e[15]||(e[15]=s("h3",{class:"section-title"},"学习总结",-1)),l(p,{"body-style":{padding:"20px"},class:"summary-card"},{default:a(()=>[s("div",ee,[e[12]||(e[12]=s("span",{class:"summary-label"},"打卡频率：",-1)),s("span",se,v(t.value.summary.checkin_frequency),1)]),s("div",le,[e[13]||(e[13]=s("span",{class:"summary-label"},"学习趋势：",-1)),s("span",te,v(t.value.summary.learning_trend),1)]),s("div",ae,[e[14]||(e[14]=s("span",{class:"summary-label"},"稳定性：",-1)),s("span",oe,v(t.value.summary.stability_level),1)])]),_:1})]),s("div",ne,[s("div",re,[e[16]||(e[16]=s("h3",{class:"section-title"},"存在问题",-1)),l(p,{"body-style":{padding:"20px"},class:"issues-card"},{default:a(()=>[t.value.issues&&t.value.issues.length>0?(n(),i("ul",ie,[(n(!0),i(B,null,D(t.value.issues,(o,A)=>(n(),i("li",{key:A,class:"issue-item"},v(o),1))),128))])):(n(),i("p",de,"暂无问题"))]),_:1})]),s("div",ue,[e[17]||(e[17]=s("h3",{class:"section-title"},"改进建议",-1)),l(p,{"body-style":{padding:"20px"},class:"suggestions-card"},{default:a(()=>[t.value.suggestions&&t.value.suggestions.length>0?(n(),i("ul",ce,[(n(!0),i(B,null,D(t.value.suggestions,(o,A)=>(n(),i("li",{key:A,class:"suggestion-item"},v(o),1))),128))])):(n(),i("p",_e,"暂无建议"))]),_:1})])]),s("div",pe,[e[19]||(e[19]=s("h3",{class:"section-title"},"推荐学习时长",-1)),l(p,{"body-style":{padding:"20px"},class:"recommended-card"},{default:a(()=>[s("div",me,[e[18]||(e[18]=s("span",{class:"hours-label"},"建议每日学习时长：",-1)),s("span",ve,v(t.value.recommended_hours)+" 小时",1)])]),_:1})])])):(n(),i("div",ye,[l(F,{description:"点击生成报告"})])),g.value?(n(),W(I,{key:2,type:"error",title:g.value,"show-icon":"",class:"error-alert"},null,8,["title"])):N("",!0)]),_:1})]),s("div",ge,[l(p,{"body-style":{padding:"30px"}},{default:a(()=>[e[22]||(e[22]=s("h2",{class:"card-title"},"AI学习教练",-1)),s("div",fe,[l(R,{"label-width":"120px",class:"data-form"},{default:a(()=>[l(u,{label:"学习目标"},{default:a(()=>[l(M,{modelValue:r.value.learning_goal,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value.learning_goal=o),placeholder:"例如：考研数学"},null,8,["modelValue"])]),_:1}),l(u,{label:"本周总学习时长"},{default:a(()=>[l(y,{modelValue:r.value.weekly_total_hours,"onUpdate:modelValue":e[2]||(e[2]=o=>r.value.weekly_total_hours=o),min:0,step:.5,placeholder:"小时"},null,8,["modelValue"])]),_:1}),l(u,{label:"平均每日学习时长"},{default:a(()=>[l(y,{modelValue:r.value.average_daily_hours,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value.average_daily_hours=o),min:0,step:.5,placeholder:"小时"},null,8,["modelValue"])]),_:1}),l(u,{label:"目标每日学习时长"},{default:a(()=>[l(y,{modelValue:r.value.target_daily_hours,"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.target_daily_hours=o),min:0,step:.5,placeholder:"小时"},null,8,["modelValue"])]),_:1}),l(u,{label:"连续打卡天数"},{default:a(()=>[l(y,{modelValue:r.value.consecutive_checkin_days,"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.consecutive_checkin_days=o),min:0,step:1,placeholder:"天"},null,8,["modelValue"])]),_:1}),l(u,{label:"漏打卡天数"},{default:a(()=>[l(y,{modelValue:r.value.missed_checkin_days,"onUpdate:modelValue":e[6]||(e[6]=o=>r.value.missed_checkin_days=o),min:0,step:1,placeholder:"天"},null,8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(U,{type:"primary",onClick:q,loading:C.value},{default:a(()=>[...e[21]||(e[21]=[S(" 获取学习指导 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),w.value?(n(),i("div",he,[l(p,{"body-style":{padding:"20px"},class:"response-card"},{default:a(()=>[s("div",{innerHTML:w.value,class:"ai-content"},null,8,ke)]),_:1})])):f.value?(n(),i("div",be,[l(I,{type:"error",title:f.value,"show-icon":"",class:"error-alert"},null,8,["title"])])):N("",!0)]),_:1})])])}}},xe=T(Ve,[["__scopeId","data-v-96e3b3d4"]]);export{xe as default};

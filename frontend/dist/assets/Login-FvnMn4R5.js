import{_ as y,u as x,o as _,c as C,a as R,b as o,w as r,d as B,e as F,r as s,f as c,g as N,h as f,i as S}from"./index-CrPuRJEc.js";const L={class:"login-form"},q={__name:"Login",setup(I){const p=N(),v=x(),n=c(null),u=c(!1),a=c(""),l=S({username:"",password:""}),w={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"长度在 3 到 50 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少 6 个字符",trigger:"blur"}]},b=async()=>{var m,e;if(n.value)try{await n.value.validate(),u.value=!0,a.value="",console.log("开始登录...");const t=await v.login(l.username,l.password);console.log("登录成功，响应:",t),console.log("localStorage中的token:",localStorage.getItem("token")),console.log("准备跳转到/home..."),p.push("/home"),console.log("跳转命令已执行")}catch(t){console.error("登录失败:",t),a.value=((e=(m=t.response)==null?void 0:m.data)==null?void 0:e.detail)||"登录失败，请检查用户名和密码"}finally{u.value=!1}},V=()=>{p.push("/auth/register")};return(m,e)=>{const t=s("el-input"),i=s("el-form-item"),g=s("el-button"),h=s("el-form"),k=s("el-alert");return _(),C("div",L,[e[4]||(e[4]=R("h2",{class:"form-title"},"登录",-1)),o(h,{model:l,rules:w,ref_key:"loginFormRef",ref:n,"label-width":"80px",class:"demo-ruleForm"},{default:r(()=>[o(i,{label:"用户名",prop:"username"},{default:r(()=>[o(t,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=d=>l.username=d),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),o(i,{label:"密码",prop:"password"},{default:r(()=>[o(t,{modelValue:l.password,"onUpdate:modelValue":e[1]||(e[1]=d=>l.password=d),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),o(i,null,{default:r(()=>[o(g,{type:"primary",class:"login-btn",onClick:b,loading:u.value},{default:r(()=>[...e[2]||(e[2]=[f(" 登录 ",-1)])]),_:1},8,["loading"]),o(g,{onClick:V},{default:r(()=>[...e[3]||(e[3]=[f(" 去注册 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),a.value?(_(),B(k,{key:0,type:"error",title:a.value,"show-icon":"",class:"error-alert"},null,8,["title"])):F("",!0)])}}},U=y(q,[["__scopeId","data-v-65cb504e"]]);export{U as default};
